<Application
    x:Class="WPFRibbon.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Luna"
    xmlns:Sync_Resources="clr-namespace:Syncfusion.Windows.Tools.Controls.Resources;assembly=Syncfusion.Tools.Wpf"
    xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=PresentationFramework"
    xmlns:local="clr-namespace:Syncfusion.Windows.Tools.Controls;assembly=Syncfusion.Tools.Wpf"
    xmlns:mwt="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Luna"
    xmlns:shared="clr-namespace:Syncfusion.Windows.Shared;assembly=Syncfusion.Shared.WPF"
    xmlns:shell="clr-namespace:Syncfusion.Windows;assembly=Syncfusion.Shared.Wpf"
    xmlns:theme="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
    StartupUri="MainWindow.xaml">
    <Application.Resources>

        <ResourceDictionary>


            <Sync_Resources:ResourceWrapper x:Key="ResourceWrapperKey" />
            <local:ColorToTransparentBrushConverter x:Key="colorToTransparentBrushConverter" />
            <local:ColorToBrushConverter x:Key="colorToBrushConverter" />
            <local:CorrectingBrushConverter x:Key="correctingBrushConverter" />
            <local:DoubleToGridLengthConverter x:Key="DoubleToGridLengthConverter" />
            <local:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />
            <local:TextWrappingConverter x:Key="TextWrappingConverter" />
            <local:GalleryFilterConverter x:Key="GalleryFilterConverter" />

            <local:FilterToRibbonButtonConverter x:Key="FilterToRibbonButtonConverter" />
            <local:SizeToDoubleConverter x:Key="SizeToDoubleConverter" />
            <local:BorderThicknessConverter x:Key="Borderthickness" />
            <local:BooleanToVisibilitySeperatorConverter x:Key="BoolInvertConverter" />
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />

            <SolidColorBrush x:Key="Office2013.QuickDropDownBorderBrush" Color="Gray"/>
            <SolidColorBrush x:Key="Office2013RibbonItemHoverBrush" Color="#FFCAD5E5" />
            <SolidColorBrush x:Key="RibbonForeground" Color="#FF3B3B3B" />
            <SolidColorBrush x:Key="RibbonBarCaptionForeground" Color="#666666" />
            <SolidColorBrush x:Key="RibbonItemCaptionForeground" Color="#1C1C1C" />
            <SolidColorBrush x:Key="Office2013PathFill" Color="#FF777777" />
            <CornerRadius x:Key="Default.AppMenuCornerRadius">3,3,3,3</CornerRadius>
            <CornerRadius x:Key="Default.QuickDropDownCornerRadius">2,2,2,2</CornerRadius>
            <Geometry x:Key="Office2013RibbonTabArrowPath">M 0 0 L 4 4 L 8 0 Z</Geometry>
            <Geometry x:Key="Office2013DropDownPath">M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z</Geometry>
            <Path
                x:Key="Path1"
                Data="{StaticResource Office2013DropDownPath}"
                Fill="{StaticResource Office2013PathFill}" />
            <SolidColorBrush x:Key="PopupBackground" Color="White" />
            <SolidColorBrush x:Key="PopupBorderBrush" Color="#FFC6C6C6" />

            <!--  AppMenu Brushes  -->
            <LinearGradientBrush x:Key="Blue.AppButton.OutterBorderFill" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFE2E7EF" />
                <GradientStop Offset="1" Color="#FFE5E7EA" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="Blue.AppButton.OutterBorder" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FF7C8CA4" />
                <GradientStop Offset="1" Color="#FF6E7E92" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="Blue.AppButton.InnerBorderFill" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFF3F5F9" />
                <GradientStop Offset="0.45" Color="#FFC8D1E0" />
                <GradientStop Offset="0.5" Color="#FF99ABC6" />
                <GradientStop Offset="1" Color="#FFDDE2E8" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="Blue.AppButton.InnerBorder" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFEFFFF" />
                <GradientStop Offset="0.5" Color="#00FFFFFF" />
                <GradientStop Offset="1" Color="#FFFFFFFF" />
            </LinearGradientBrush>

            <RadialGradientBrush x:Key="Blue.AppButton.TopHighlight" Center="0.5,0" GradientOrigin="0.5,0" RadiusX="0.7" RadiusY="0.6">
                <GradientStop Offset="0" Color="#A0E2E6ED" />
                <GradientStop Offset="1" Color="#00FFFFFF" />
            </RadialGradientBrush>

            <RadialGradientBrush x:Key="Blue.AppButton.BottomHighlight" Center="0.5,1" GradientOrigin="0.5,1" RadiusX="0.4" RadiusY="0.6">
                <GradientStop Offset="0" Color="#FFFFFFFF" />
                <GradientStop Offset="1" Color="#00FFFFFF" />
            </RadialGradientBrush>

            <LinearGradientBrush x:Key="AppButtonHoverOutterBorderFill" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFFE74C" />
                <GradientStop Offset="1" Color="#FFFFF42E" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AppButtonHoverInnerBorderFill" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFFFBE7" />
                <GradientStop Offset="0.49" Color="#FFEFD682" />
                <GradientStop Offset="0.5" Color="#FFDEAD18" />
                <GradientStop Offset="1" Color="#FFFFF72C" />
            </LinearGradientBrush>

            <RadialGradientBrush x:Key="AppButtonHoverTopHighlight" Center="0.5,0" GradientOrigin="0.5,0" RadiusX="0.7" RadiusY="0.6">
                <GradientStop Offset="0" Color="#FFFFFFFE" />
                <GradientStop Offset="1" Color="#00FFFFFF" />
            </RadialGradientBrush>

            <RadialGradientBrush x:Key="AppButtonHoverBottomHighlight" Center="0.5,1" GradientOrigin="0.5,0.95" RadiusX="0.6" RadiusY="0.8">
                <GradientStop Offset="0" Color="#FFFDFABE" />
                <GradientStop Offset="0.4" Color="#FFFEE42F" />
                <GradientStop Offset="1" Color="#00FFFFFF" />
            </RadialGradientBrush>

            <LinearGradientBrush x:Key="AppButtonHoverOutterBorder" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFABA271" />
                <GradientStop Offset="1" Color="#FF6E7E92" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AppButtonHoverInnerBorder" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFFED61" />
                <GradientStop Offset="0.5" Color="#FFFFE979" />
                <GradientStop Offset="0.5" Color="#FFF7D732" />
                <GradientStop Offset="1" Color="#FFE8E23A" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AppButtonExpandedOutterBorderFill" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFFFEFF" />
                <GradientStop Offset="1" Color="#FFE87824" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AppButtonExpandedInnerBorderFill" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFF9F1E7" />
                <GradientStop Offset="0.48" Color="#FFCFA76A" />
                <GradientStop Offset="0.5" Color="#FFAD6808" />
                <GradientStop Offset="1" Color="#FFF77706" />
            </LinearGradientBrush>

            <RadialGradientBrush x:Key="AppButtonExpandedTopHighlight" Center="0.5,0" GradientOrigin="0.5,0" RadiusX="0.7" RadiusY="0.6">
                <GradientStop Offset="0" Color="#10FEFDFE" />
                <GradientStop Offset="1" Color="#00FFFFFF" />
            </RadialGradientBrush>

            <RadialGradientBrush x:Key="AppButtonExpandedBottomHighlight" Center="0.5,1" GradientOrigin="0.5,1" RadiusX="0.4" RadiusY="0.4">
                <GradientStop Offset="0" Color="#FFF2CF94" />
                <GradientStop Offset="1" Color="#00FFFFFF" />
            </RadialGradientBrush>

            <LinearGradientBrush x:Key="AppButtonExpandedOutterBorder" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Offset="0" Color="#FFB17A34" />
                <GradientStop Offset="1" Color="#FF727F92" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AppButtonExpandedInnerBorder" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFEFDFE" />
                <GradientStop Offset="0.5" Color="#FFD7BB96" />
                <GradientStop Offset="0.5" Color="#FFCB8A0D" />
                <GradientStop Offset="1" Color="#FFFF9C30" />
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="AppMenuBackground" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFC0D3EB" />
                <GradientStop Offset="1" Color="#FFC0D5F0" />
            </LinearGradientBrush>

            <SolidColorBrush x:Key="Blue.Foreground" Color="#FF00156E" />
            <SolidColorBrush x:Key="Blue.Foreground2" Color="#FF00156E" />
            <!--  RibbonAppMenuBrushes  -->
            <SolidColorBrush x:Key="Blue.AppMenu.Background2" Color="#FFFAFAFA" />
            <SolidColorBrush x:Key="Blue.AppMenu.Background3" Color="#FFFAFAFA" />
            <SolidColorBrush x:Key="Blue.AppMenu.BorderBrush1" Color="#FFFFFFFF" />
            <SolidColorBrush x:Key="Blue.AppMenu.BorderBrush2" Color="#FF9BAFCA" />
            <SolidColorBrush x:Key="Blue.AppMenu.BorderBrush3" Color="#FFC5C5C5" />
            <SolidColorBrush x:Key="Blue.AppMenu.BorderBrush4" Color="#FFF5F5F5" />
            <SolidColorBrush x:Key="Blue.AppMenu.Background" Color="White"/>
            <SolidColorBrush x:Key="Blue.AppMenu.BackgroundBottom" Color="White"/>

            <SolidColorBrush x:Key="Blue.AppMenu.BackgroundTop" Color="#FFFAFAFA"/>
            <LinearGradientBrush x:Key="Blue.AppMenu.InnerBorderBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0" Color="#FFFFFFFF" />
                <GradientStop Offset="0.85" Color="#FFFFFFFF" />
                <GradientStop Offset="1" Color="#FFC9EEFF" />
            </LinearGradientBrush>
            <SolidColorBrush x:Key="Blue.AppMenu.OutterBorderBrush" Color="#FF9BAFCA" />

            <!--  End RibbonAppMenuBrushes  -->
           

            <SolidColorBrush x:Key="Office2013.MenuButton.MouseOverBrush" Color="#FFCAD5E5"/>
            <SolidColorBrush x:Key="Office2013.MenuButton.OutterBorderBrush" Color="#FF9BAFCA"/>
            <SolidColorBrush x:Key="Office2013.MenuButton.InnerBorderBrush" Color="#FF9BAFCA"/>

            <!--  ScrollBar Brushes  -->


            <SolidColorBrush x:Key="Office2013ScrollBarThumbBackgroundBrush" Color="White" />
            <SolidColorBrush x:Key="Office2013ScrollBarThumbBorderBrush" Color="#FFABABAB" />
            <SolidColorBrush x:Key="Office2013ScollBarThumbHoverBrush" Color="#FFF0F0F0" />
            <SolidColorBrush x:Key="Office2013ScrollBarPressedBorderBrush" Color="#FF777777" />
            <SolidColorBrush x:Key="Office2013ScrollBarBackground" Color="#FFEAEAEA" />
            <SolidColorBrush x:Key="Office2013ScrollBarRepleatButtonHoverBorderBrush" Color="#FF777777" />
            <SolidColorBrush x:Key="Office2013ScrollBarRepeatButtonPressedBrush" Color="#FFF0F0F0" />
            <SolidColorBrush x:Key="CornerBackground" Color="#FFFFFFFF" />
            <SolidColorBrush x:Key="Office2013BackstageButtonForeground" Color="White" />

            <!--  ItemsControlInternalItemStyle  -->

            <Style x:Key="ItemsControlInternalItemStyle" TargetType="shared:ItemsControlInternalItem">
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Margin" Value="5,4,5,4" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="shared:ItemsControlInternalItem">
                            <Border
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2">
                                <ContentPresenter
                                    Margin="-1"
                                    Content="{TemplateBinding Content}"
                                    DataContext="{Binding Path=DataContext, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type shared:ItemsControlInternal}}}" />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="BorderBrush" Value="Transparent" />
                    </Trigger>
                </Style.Triggers>
            </Style>


            <!--  ApplicationMenu Style  -->
            <Style x:Key="Office2007BlueApplicationMenuStyle" TargetType="{x:Type local:ApplicationMenu}">
                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="Width" Value="65"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:ApplicationMenu}">
                            <Grid
                                x:Name="PART_ButtonGrid" 
                                Width="65"
                                SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}">
                                <Border x:Name="border2"
                            Height="25"
                            Width="65"
                            Margin="-10,0,0,0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Background="{Binding Path=BackStageColor,
                                                 RelativeSource={RelativeSource AncestorType={x:Type local:Ribbon}}}"
                            SnapsToDevicePixels="True">
                                    <Grid>
                                        <TextBlock x:Name="contentPresenter"
                                        Height="25"
                                        Width="65" Padding="3"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center" TextAlignment="Center"
                                       SnapsToDevicePixels="True"
                                       Text="File"
                                       TextBlock.Foreground="{StaticResource Office2013BackstageButtonForeground}"
                                       TextTrimming="CharacterEllipsis"
                                       TextWrapping="NoWrap">
                                            <TextBlock.Effect>
                                                <DropShadowEffect BlurRadius="4"
                                                      Opacity="0.605"
                                                      ShadowDepth="0" />
                                            </TextBlock.Effect>
                                        </TextBlock>

                                    </Grid>
                                    </Border>
                                <local:CustomPopup
                                    x:Name="PART_Popup"
                                    AllowsTransparency="True"
                                    Focusable="False"
                                    HorizontalOffset="-3"
                                    IsOpen="{Binding Path=IsPopupOpen, Mode=TwoWay, UpdateSourceTrigger=Explicit, RelativeSource={RelativeSource TemplatedParent}}"
                                    Placement="Bottom"
                                    PopupAnimation="Fade"
                                    SnapsToDevicePixels="True"
                                    StaysOpen="False"
                                    VerticalOffset="-16">
                                    <mwt:SystemDropShadowChrome Name="Shdw" Margin="0">
                                        <Grid x:Name="mainGrid">
                                            <Border
                                                BorderBrush="{StaticResource Blue.AppMenu.OutterBorderBrush}"
                                                BorderThickness="1,1,1,1"
                                                CornerRadius="{StaticResource Default.AppMenuCornerRadius}">
                                                <Border
                                                    Background="{StaticResource Blue.AppMenu.Background}"
                                                    BorderBrush="{StaticResource Blue.AppMenu.InnerBorderBrush}"
                                                    BorderThickness="1,1,1,1"
                                                    CornerRadius="{StaticResource Default.QuickDropDownCornerRadius}">
                                                    <DockPanel LastChildFill="True">
                                                        <Border
                                                            Height="15"
                                                            Background="{StaticResource Blue.AppMenu.BackgroundTop}"
                                                            CornerRadius="2,2,2,2"
                                                            DockPanel.Dock="Top" />
                                                        <DockPanel LastChildFill="True">
                                                            <Border
                                                                Height="Auto"
                                                                VerticalAlignment="Bottom"
                                                                Background="{StaticResource Blue.AppMenu.BackgroundBottom}"
                                                                CornerRadius="0,0,2,2"
                                                                DockPanel.Dock="Bottom">
                                                                <shared:ItemsControlInternal
                                                                    x:Name="PART_AppItems"
                                                                    Margin="0,-2,0,-1"
                                                                    Padding="1,3,1,3"
                                                                    HorizontalAlignment="Right"
                                                                    ItemContainerStyle="{StaticResource ItemsControlInternalItemStyle}"
                                                                    Visibility="Visible">
                                                                    <shared:ItemsControlInternal.ItemsPanel>
                                                                        <ItemsPanelTemplate>
                                                                            <StackPanel
                                                                                IsItemsHost="True"
                                                                                KeyboardNavigation.DirectionalNavigation="Contained"
                                                                                Orientation="Horizontal" />
                                                                        </ItemsPanelTemplate>
                                                                    </shared:ItemsControlInternal.ItemsPanel>
                                                                </shared:ItemsControlInternal>
                                                            </Border>
                                                            <Border
                                                                Grid.Row="1"
                                                                BorderBrush="{StaticResource Blue.AppMenu.BorderBrush1}"
                                                                BorderThickness="1,1,1,1">
                                                                <Border
                                                                    Background="{StaticResource Blue.AppMenu.Background2}"
                                                                    BorderBrush="{StaticResource Blue.AppMenu.BorderBrush2}"
                                                                    BorderThickness="1,1,1,1">
                                                                    <DockPanel LastChildFill="True">
                                                                        <Border
                                                                            x:Name="PART_Border"
                                                                            MinWidth="{TemplateBinding PreviewPanelMinWidth}"
                                                                            Background="{StaticResource Blue.AppMenu.Background3}"
                                                                            BorderBrush="{StaticResource Blue.AppMenu.BorderBrush3}"
                                                                            BorderThickness="1,0,0,0"
                                                                            DockPanel.Dock="Right"
                                                                            Visibility="Visible">
                                                                            <Border
                                                                                Padding="2,2,2,2"
                                                                                BorderBrush="{StaticResource Blue.AppMenu.BorderBrush4}"
                                                                                BorderThickness="1,0,0,0">
                                                                                <ItemsControl
                                                                                    x:Name="PART_MenuItems"
                                                                                    Foreground="{StaticResource RibbonForeground}"
                                                                                    ItemTemplate="{x:Null}"
                                                                                    ItemsSource="{TemplateBinding internalMenuItems}" />
                                                                            </Border>
                                                                        </Border>
                                                                        <ScrollViewer
                                                                            Margin="0,0,-5,-5"
                                                                            HorizontalScrollBarVisibility="Hidden"
                                                                            VerticalScrollBarVisibility="Hidden">
                                                                            <ItemsPresenter
                                                                                x:Name="PART_Items"
                                                                                Margin="0,0,5,5"
                                                                                KeyboardNavigation.DirectionalNavigation="Contained"
                                                                                KeyboardNavigation.TabNavigation="Cycle"
                                                                                SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
                                                                        </ScrollViewer>
                                                                    </DockPanel>
                                                                </Border>
                                                            </Border>
                                                        </DockPanel>
                                                    </DockPanel>
                                                </Border>
                                            </Border>
                                            <Grid
                                                Name="PART_FakeAppButton"
                                                Width="38"
                                                Height="38"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top">
                                                <!--<Ellipse
                                                    Width="37"
                                                    Height="37"
                                                    Fill="{StaticResource AppButtonExpandedOutterBorderFill}"
                                                    Stroke="{StaticResource Blue.AppButton.OutterBorder}"
                                                    StrokeThickness="1" />
                                                <Ellipse
                                                    Width="37"
                                                    Height="37"
                                                    Opacity="0.6"
                                                    Stroke="{StaticResource AppButtonExpandedOutterBorder}"
                                                    StrokeThickness="1">
                                                    <Ellipse.RenderTransform>
                                                        <TranslateTransform X="1" Y="0.4" />
                                                    </Ellipse.RenderTransform>
                                                </Ellipse>-->
                                                <!--<Ellipse
                                                    Width="35"
                                                    Height="35"
                                                    Fill="{StaticResource AppButtonExpandedInnerBorderFill}"
                                                    Stroke="{StaticResource Blue.AppButton.InnerBorder}" />
                                                <Ellipse
                                                    Width="33"
                                                    Height="33"
                                                    Fill="{StaticResource AppButtonExpandedTopHighlight}" />
                                                <Ellipse
                                                    Width="33"
                                                    Height="33"
                                                    Fill="{StaticResource AppButtonExpandedBottomHighlight}" />-->
                                                <!--<Image
                                                    Width="{Binding Path=ApplicationButtonImageWidth, RelativeSource={RelativeSource TemplatedParent}}"
                                                    Height="{Binding Path=ApplicationButtonImageHeight, RelativeSource={RelativeSource TemplatedParent}}"
                                                    Margin="1.5,1,0,0"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    SnapsToDevicePixels="True"
                                                    Source="{Binding Path=ApplicationButtonImage, RelativeSource={RelativeSource TemplatedParent}}" />-->
                                                <Grid.RenderTransform>
                                                    <TranslateTransform X="0" Y="-22" />
                                                </Grid.RenderTransform>
                                            </Grid>
                                        </Grid>
                                    </mwt:SystemDropShadowChrome>
                                    <local:CustomPopup.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                    <Setter Property="Popup.VerticalOffset" Value="-90" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </local:CustomPopup.Style>
                                </local:CustomPopup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger SourceName="PART_Popup" Property="HasDropShadow" Value="True">
                                    <Setter TargetName="Shdw" Property="Margin" Value="0,0,4,4" />
                                </Trigger>
                                <Trigger Property="IsBelowAppButton" Value="False">
                                    <Setter TargetName="PART_FakeAppButton" Property="Visibility" Value="Hidden" />
                                    <Setter TargetName="PART_Popup" Property="VerticalOffset" Value="-5" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="PART_ButtonGrid" Property="FrameworkElement.Height" Value="48" />
                                    <Setter TargetName="PART_ButtonGrid" Property="FrameworkElement.Width" Value="65" />
                                    <Setter TargetName="PART_FakeAppButton" Property="FrameworkElement.Height" Value="48" />
                                    <Setter TargetName="PART_FakeAppButton" Property="FrameworkElement.Width" Value="48" />
                                    <Setter TargetName="PART_FakeAppButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="mainGrid" Property="Width" Value="330" />
                                    <Setter TargetName="PART_Border" Property="Margin" Value="5,0,5,0" />
                                    <Setter TargetName="PART_Border" Property="Width" Value="150" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style BasedOn="{StaticResource Office2007BlueApplicationMenuStyle}" TargetType="{x:Type local:ApplicationMenu}" />

            <ContentControl x:Key="Path">
                <ContentControl.Style>
                    <Style>
                        <Setter Property="TextBlock.Foreground" Value="{StaticResource Office2013PathFill}" />
                        <Setter Property="Control.OverridesDefaultStyle" Value="True" />
                        <Setter Property="Control.HorizontalAlignment" Value="Center" />
                        <Setter Property="Control.VerticalAlignment" Value="Top" />
                        <Setter Property="Control.Height" Value="14" />
                        <Setter Property="Control.Margin" Value="0,-1,0,0" />
                        <Setter Property="Control.Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ContentControl">
                                    <Border>
                                        <Path
                                            Width="5"
                                            Height="3"
                                            Margin="0,4,0,0"
                                            HorizontalAlignment="Center"
                                            Data="{StaticResource Office2013DropDownPath}"
                                            Fill="{StaticResource Office2013PathFill}"
                                            Stretch="Fill" />
                                    </Border>

                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ContentControl.Style>
            </ContentControl>


            <Color
                x:Key="Blue.TapPanel.SeparatorColor"
                B="227"
                G="178"
                R="141" />





            <!--  ResizeGripper  -->
            <SolidColorBrush x:Key="Blue.ResizeGripperForegroundDark" Color="#455D80" />
            <SolidColorBrush x:Key="Blue.ResizeGripperForegroundLight" Color="#B1C9E8" />
            <SolidColorBrush x:Key="TransparentBrush" Color="Transparent" />


            <!--  Ribbon Normal State Template  -->
            <ControlTemplate x:Key="Normal" TargetType="{x:Type local:Ribbon}">
                <AdornerDecorator
                    Name="PART_AdornerDecorator"
                    Margin="0,-53,0,0"
                    Panel.ZIndex="100"
                    DockPanel.Dock="Top">
                    <Border>
                        <Grid ClipToBounds="True">
                            <Grid.RowDefinitions>
                                <RowDefinition>
                                    <RowDefinition.Style>
                                        <Style>
                                            <Setter Property="RowDefinition.Height" Value="53" />
                                            <Style.Triggers>
                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                    <Setter Property="RowDefinition.Height" Value="73" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </RowDefinition.Style>
                                </RowDefinition>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                <local:RibbonWindowPanel
                                    x:Name="PART_RibbonWindowPanel"
                                    MinHeight="53"
                                    Panel.ZIndex="100"
                                    DockPanel.Dock="Top">
                                    <Border
                                        x:Name="PART_TitleBorder"
                                        Width="{TemplateBinding ActualWidth}"
                                        Height="30"
                                        Margin="0,0,0,-20"
                                        Visibility="Collapsed" />
                                    <ContentPresenter
                                        Name="PART_ApplicationMenu"
                                        Margin="0,20,0,0" Width="65"
                                        Content="{TemplateBinding ApplicationMenu}"
                                        ContentSource="ApplicationMenu">
                                       
                                    </ContentPresenter>
                                    <ContentPresenter
                                        Margin="30,0,0,0"
                                        HorizontalAlignment="Center"
                                        Content="{TemplateBinding QuickAccessToolBar}">
                                        <ContentPresenter.Style>
                                            <Style>
                                                <Setter Property="FrameworkElement.Height" Value="31" />
                                                <Style.Triggers>
                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                        <Setter Property="FrameworkElement.Height" Value="40" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ContentPresenter.Style>
                                    </ContentPresenter>
                                </local:RibbonWindowPanel>
                                <Border
                                    Width="5"
                                    Height="1"
                                    Margin="0,-14,0,0"
                                    DockPanel.Dock="Left" />
                                <Border
                                    Width="41"
                                    Height="0"
                                    Margin="0,-14,0,0"
                                    Panel.ZIndex="11"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="0,0,0,0"
                                    DockPanel.Dock="Left" />
                                <Border
                                    Width="5"
                                    Height="0.02"
                                    Margin="0,-14,0,0"
                                    Panel.ZIndex="12"
                                    DockPanel.Dock="Right" />
                                <Border
                                    Panel.ZIndex="12"
                                    BorderThickness="0"
                                    DockPanel.Dock="Right">
                                    <Border.Style>
                                        <Style>
                                            <Setter Property="Border.Margin" Value="0,-24,0,1" />
                                            <Setter Property="Border.Height" Value="23" />
                                            <Style.Triggers>
                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                    <Setter Property="Border.Margin" Value="0,-39,0,1" />
                                                    <Setter Property="Border.Height" Value="40" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <ContentPresenter ContentSource="TabPanelItem" />
                                </Border>

                                <Border
                                    x:Name="ribbonTabBorder"
                                    Panel.ZIndex="10"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    DockPanel.Dock="Bottom">
                                    <Border.Style>
                                        <Style>
                                            <!--<Setter Property="Border.Margin" Value="17,-25,0,2"/>-->
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Visible">
                                                    <Setter Property="Border.Margin" Value="17,-25,0,2" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Collapsed">
                                                    <Setter Property="Border.Margin" Value="-46,-25,0,2" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <ItemsPresenter Focusable="False" KeyboardNavigation.IsTabStop="False" />
                                </Border>
                            </DockPanel>


                            <Border
                                x:Name="ribBorder"
                                Grid.Row="1"
                                Margin="0,-1,0,0"
                                Padding="0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="0,1,0,1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <local:RibbonTabItemsControl
                                        DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.DisplayMemberPath}"
                                        Focusable="False"
                                        ItemContainerStyle="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemContainerStyle}"
                                        ItemContainerStyleSelector="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemContainerStyleSelector}"
                                        ItemStringFormat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemStringFormat}"
                                        ItemTemplate="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemTemplate}"
                                        ItemTemplateSelector="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemTemplateSelector}"
                                        ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.Items}">

                                        <local:RibbonTabItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <local:RibbonLayoutPanel />
                                            </ItemsPanelTemplate>
                                        </local:RibbonTabItemsControl.ItemsPanel>
                                    </local:RibbonTabItemsControl>
                                    <Grid Grid.Column="1" HorizontalAlignment="Right">
                                        <local:RibbonToggleButton
                                            x:Name="ToggleButton"
                                            Width="29"
                                            Height="22"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Bottom"
                                            Panel.ZIndex="12"
                                            Style="{DynamicResource RibbonToggleButtonStyle}"
                                            Visibility="{TemplateBinding MinimizeButtonVisibility}" />
                                    </Grid>
                                </Grid>
                            </Border>

                        </Grid>
                    </Border>
                </AdornerDecorator>
                <ControlTemplate.Triggers>
                    <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                        <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0,-53,0,0" />
                    </Trigger>
                    <!--<Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
			<Setter TargetName="PART_RibbonWindowPanel" Property="MinHeight" Value="73"/>
                <Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>
                <Setter Property="Margin" Value="0,-3,0,0" TargetName="ribBorder"/>
            </Trigger>-->

                </ControlTemplate.Triggers>
            </ControlTemplate>

            <!--  ContextAdorner Style  -->
            <Style x:Key="Office2013ContextAdornerStyle" TargetType="{x:Type shared:TemplatedAdornerInternalControl}">
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Path=ContextTabGroup.Visibility}" />
                <Setter Property="Background" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Converter={StaticResource colorToTransparentBrushConverter}, Path=ContextTabGroup.BackColor}" />
                <Setter Property="Height" Value="57" />
                <Setter Property="Foreground" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Converter={StaticResource colorToBrushConverter}, Path=ContextTabGroup.BackColor}" />
                <Setter Property="SnapsToDevicePixels" Value="True" />
                <Setter Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Converter={StaticResource colorToTransparentBrushConverter}, Path=ContextTabGroup.BackColor}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type shared:TemplatedAdornerInternalControl}">


                            <Border
                                x:Name="Bd"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}"
                                Margin="0,5,0,0"
                                BorderBrush="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Converter={StaticResource colorToBrushConverter}, Path=ContextTabGroup.BackColor}"
                                BorderThickness="0,4,0,0"
                                IsHitTestVisible="False">
                                <Grid>
                                    <Border Background="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Converter={StaticResource colorToBrushConverter}, Path=ContextTabGroup.BackColor}" Opacity="0.10" />

                                    <TextBlock
                                        x:Name="PART_Label"
                                        Margin="8,3,3,0"
                                        HorizontalAlignment="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=TabGroupLabelAlignment}"
                                        FontSize="14"
                                        FontWeight="thin"
                                        Foreground="{TemplateBinding Foreground}"
                                        Text="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ContextAdorner}}, Path=ContextTabGroup.Label}"
                                        TextAlignment="Center"
                                        TextTrimming="CharacterEllipsis" />

                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>


                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Normal" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="PART_Label" Property="BitmapEffect">
                                        <Setter.Value>
                                            <OuterGlowBitmapEffect
                                                GlowColor="#FFFFFFFF"
                                                GlowSize="10"
                                                Opacity="1" />
                                        </Setter.Value>
                                    </Setter>
                                </MultiDataTrigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="Bd" Property="Margin" Value="0" />
                                    <Setter TargetName="Bd" Property="BorderThickness" Value="0,5,0,0" />
                                    <Setter Property="Height" Value="72" />
                                    <Setter Property="Margin" Value="0,-15,0,0" />
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <SolidColorBrush x:Key="Office2013RibbonBackgroundBrush" Color="White" />

            <SolidColorBrush x:Key="RibbonBorderBrush" Color="#FFD4D4D4" />
            <SolidColorBrush x:Key="RibbonBackStageColor" Color="#FF2B579A" />

            <!--  Ribbon style  -->
            <local:BackStageButton x:Key="BackStageOffice2013Key" shell:WindowChrome.IsHitTestVisibleInChrome="True">
                <local:BackStageButton.Style>
                    <Style TargetType="{x:Type local:BackStageButton}">
                        <Setter Property="Width" Value="61" />
                        <Setter Property="Height" Value="25" />
                        <Setter Property="Margin" Value="-2,28,0,0" />
                        <Setter Property="Focusable" Value="False" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:BackStageButton}">
                                    <!--<Border
                                        x:Name="border2"
                                        Height="25"
                                        MinWidth="62"
                                        Margin="0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="{Binding Path=BackStageColor, RelativeSource={RelativeSource AncestorType={x:Type local:Ribbon}}}"
                                        SnapsToDevicePixels="True">
                                        <Grid Margin="2,0,2,0">
                                            <TextBlock
                                                x:Name="contentPresenter"
                                                Margin="0,5"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                SnapsToDevicePixels="True"
                                                Text="{TemplateBinding Header}"
                                                TextBlock.Foreground="{StaticResource Office2013BackstageButtonForeground}"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect
                                                        BlurRadius="4"
                                                        Opacity="0.605"
                                                        ShadowDepth="0" />
                                                </TextBlock.Effect>
                                            </TextBlock>

                                        </Grid>
                                    </Border>-->
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                <Setter Property="Width" Value="64" />
                                <Setter Property="Height" Value="30" />
                                <Setter Property="Margin" Value="-2,45,0,0" />
                            </Trigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding RibbonState, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}}" Value="Normal" />
                                    <Condition Binding="{Binding IsQATBelow, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}}" Value="True" />
                                    <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch), RelativeSource={RelativeSource Self}}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Margin" Value="-2,45,0,0" />
                            </MultiDataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding RibbonState, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}}" Value="Hide" />
                                    <Condition Binding="{Binding IsQATBelow, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}}" Value="True" />
                                    <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch), RelativeSource={RelativeSource Self}}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Margin" Value="-2,45,0,0" />
                            </MultiDataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding RibbonState, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}}" Value="Adorner" />
                                    <Condition Binding="{Binding IsQATBelow, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}}" Value="True" />
                                    <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch), RelativeSource={RelativeSource Self}}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Margin" Value="-2,45,0,0" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </local:BackStageButton.Style>

            </local:BackStageButton>
            <Style x:Key="Office2013RibbonStyle" TargetType="{x:Type local:Ribbon}">
                <Setter Property="BackStageColor" Value="{StaticResource RibbonBackStageColor}" />
                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter Property="Panel.ZIndex" Value="1000" />
                <Setter Property="TabGroupLabelAlignment" Value="Center" />
                <Setter Property="FocusManager.IsFocusScope" Value="True" />
                <Setter Property="ContextAdornerStyle" Value="{StaticResource Office2013ContextAdornerStyle}" />
                <Setter Property="BackStageButton" Value="{StaticResource BackStageOffice2013Key}" />
                <Setter Property="Height" Value="95" />
                <Setter Property="Focusable" Value="False" />
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate>
                            <local:TabPanel Name="TabPanel" SeparatorColor="{StaticResource Blue.TapPanel.SeparatorColor}" />
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="{StaticResource Office2013RibbonBackgroundBrush}" />
                <Setter Property="BorderBrush" Value="{StaticResource RibbonBorderBrush}" />

                <Style.Triggers>

                    <Trigger Property="RibbonState" Value="Normal">
                        <Setter Property="Template" Value="{StaticResource Normal}" />
                    </Trigger>


                    <Trigger Property="RibbonState" Value="Adorner">
                        <Setter Property="Height" Value="0" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:Ribbon}">
                                    <AdornerDecorator
                                        Name="PART_AdornerDecorator"
                                        Margin="0,-53,0,0"
                                        Panel.ZIndex="100"
                                        DockPanel.Dock="Top">
                                        <Border>
                                            <Grid x:Name="LayoutGrid" ClipToBounds="True">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="53" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="73" />
                                                                    </Trigger>
                                                                    <!--<DataTrigger Binding="{Binding IsQATBelow,RelativeSource={RelativeSource AncestorType={x:Type local:Ribbon}}}" Value="True">
                                                                <Setter Property="RowDefinition.Height" Value="53"/>
                                                            </DataTrigger>-->
                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>

                                                </Grid.RowDefinitions>
                                                <DockPanel
                                                    x:Name="dockPanel"
                                                    Grid.Row="0"
                                                    Panel.ZIndex="200">
                                                    <local:RibbonWindowPanel
                                                        x:Name="PART_RibbonWindowPanel"
                                                        Panel.ZIndex="100"
                                                        DockPanel.Dock="Top">
                                                        <Border
                                                            x:Name="PART_TitleBorder"
                                                            Width="{TemplateBinding ActualWidth}"
                                                            Height="30"
                                                            Margin="0,0,0,-20"
                                                            Visibility="Collapsed" />
                                                        <ContentPresenter
                                                            Name="PART_ApplicationMenu"
                                                            Margin="0,20,0,0" Width="65"
                                                            Content="{TemplateBinding ApplicationMenu}"
                                                            ContentSource="ApplicationMenu">
                                                            <ContentPresenter.Style>
                                                                <Style>
                                                                    <Setter Property="FrameworkElement.Height" Value="38" />
                                                                    <Setter Property="FrameworkElement.Width" Value="38" />
                                                                    <Style.Triggers>
                                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                            <Setter Property="FrameworkElement.Height" Value="48" />
                                                                            <Setter Property="FrameworkElement.Width" Value="48" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentPresenter.Style>
                                                        </ContentPresenter>
                                                        <ContentPresenter
                                                            Margin="30,0,0,0"
                                                            HorizontalAlignment="Center"
                                                            shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                                            Content="{TemplateBinding QuickAccessToolBar}"
                                                            Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsQATBelow, Converter={StaticResource BoolInvertConverter}}">
                                                            <ContentPresenter.Style>
                                                                <Style>
                                                                    <Setter Property="FrameworkElement.Height" Value="31" />
                                                                    <Style.Triggers>
                                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                            <Setter Property="FrameworkElement.Height" Value="35" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentPresenter.Style>
                                                        </ContentPresenter>
                                                    </local:RibbonWindowPanel>
                                                    <Border
                                                        Width="5"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="41"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="11"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="0,0,0,1"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="5"
                                                        Height="0.02"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="12"
                                                        DockPanel.Dock="Right" />
                                                    <Border
                                                        Panel.ZIndex="12"
                                                        Background="{StaticResource TransparentBrush}"
                                                        DockPanel.Dock="Right">
                                                        <Border.Style>
                                                            <Style>
                                                                <Setter Property="Border.Margin" Value="0,-23,0,1" />
                                                                <Setter Property="Border.Height" Value="28" />
                                                                <!--<Style.Triggers>
                                                            <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                <Setter Property="Border.Margin" Value="0,-39,0,1" />
                                                                <Setter Property="Border.Height" Value="40"/>
                                                            </Trigger>
                                                        </Style.Triggers>-->
                                                            </Style>
                                                        </Border.Style>
                                                        <ContentPresenter ContentSource="TabPanelItem" />
                                                    </Border>

                                                    <Border
                                                        x:Name="ribbonTabBorder"
                                                        Panel.ZIndex="10"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        DockPanel.Dock="Bottom">
                                                        <Border.Style>
                                                            <Style>
                                                                <!--<Setter Property="Border.Margin" Value="17,-24,0,1"/>-->
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Visible">
                                                                        <Setter Property="Border.Margin" Value="17,-25,0,2" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                        <Setter Property="Border.Margin" Value="-46,-25,0,2" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                        <ItemsPresenter />
                                                    </Border>
                                                </DockPanel>

                                                <Popup
                                                    x:Name="Part_AdornerPopup"
                                                    AllowsTransparency="True"
                                                    ClipToBounds="True"
                                                    IsOpen="False"
                                                    PlacementTarget="{Binding ElementName=dockPanel}"
                                                    StaysOpen="False">
                                                    <Border MinHeight="92" Margin="0,7,0,15">
                                                        <Border
                                                            x:Name="AdornerTabPanelBorder"
                                                            Padding="0"
                                                            VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                            Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="0,1,0,1">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <local:RibbonTabItemsControl
                                                                    DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.DisplayMemberPath}"
                                                                    Focusable="False"
                                                                    ItemContainerStyle="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemContainerStyle}"
                                                                    ItemContainerStyleSelector="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemContainerStyleSelector}"
                                                                    ItemStringFormat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemStringFormat}"
                                                                    ItemTemplate="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemTemplate}"
                                                                    ItemTemplateSelector="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemTemplateSelector}"
                                                                    ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.Items}">

                                                                    <local:RibbonTabItemsControl.ItemsPanel>
                                                                        <ItemsPanelTemplate>
                                                                            <local:RibbonLayoutPanel />
                                                                        </ItemsPanelTemplate>
                                                                    </local:RibbonTabItemsControl.ItemsPanel>
                                                                </local:RibbonTabItemsControl>
                                                                <Grid Grid.Column="1" HorizontalAlignment="Right">
                                                                    <local:RibbonToggleButton
                                                                        x:Name="ToggleButton"
                                                                        Width="29"
                                                                        Height="22"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Bottom"
                                                                        Panel.ZIndex="12"
                                                                        local:Ribbon.IsQATItem="False"
                                                                        Style="{DynamicResource RibbonToggleButtonStyle}"
                                                                        Visibility="{TemplateBinding MinimizeButtonVisibility}" />
                                                                </Grid>
                                                            </Grid>
                                                            <Border.Style>
                                                                <Style>
                                                                    <Style.Triggers>
                                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                            <Setter Property="Border.Margin" Value="0,-3,0,0" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                        </Border>
                                                    </Border>
                                                </Popup>
                                            </Grid>

                                        </Border>
                                    </AdornerDecorator>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                            <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                        </Trigger>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=SelectedTabItem.HasContextTabGroup}" Value="True">
                                            <Setter TargetName="AdornerTabPanelBorder" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Converter={StaticResource colorToBrushConverter}, Path=SelectedContextTabGroupBackColor}" />
                                            <Setter TargetName="AdornerTabPanelBorder" Property="BorderThickness" Value="0,1,0,1" />
                                            <!--<Setter TargetName="AdornerTabPanelBorder" Property="Margin" Value="0,0,0,0" />-->
                                        </DataTrigger>
                                        <!--<Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>
                                </Trigger>-->
                                        <MultiTrigger>
                                            <MultiTrigger.Conditions>
                                                <Condition Property="RibbonState" Value="Adorner" />
                                                <Condition Property="IsQATBelow" Value="True" />
                                                <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                                            </MultiTrigger.Conditions>
                                            <!--<Setter Property="Margin" Value="17,-27,0,2" TargetName="ribbonTabBorder"/>-->
                                        </MultiTrigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>

                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Normal" />
                            <Condition Property="IsQATBelow" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="125" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:Ribbon}">
                                    <AdornerDecorator
                                        Name="PART_AdornerDecorator"
                                        Margin="0,-53,0,0"
                                        Panel.ZIndex="100"
                                        DockPanel.Dock="Top">
                                        <Border>
                                            <Grid ClipToBounds="True">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="53" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="73" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="95" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="125" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="30" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="41" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>
                                                </Grid.RowDefinitions>
                                                <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                                    <local:RibbonWindowPanel
                                                        x:Name="PART_RibbonWindowPanel"
                                                        Panel.ZIndex="100"
                                                        DockPanel.Dock="Top">
                                                        <Border
                                                            x:Name="PART_TitleBorder"
                                                            Width="{TemplateBinding ActualWidth}"
                                                            Height="30"
                                                            Margin="0,0,0,-20"
                                                            Visibility="Collapsed" />
                                                        <ContentPresenter Content="{TemplateBinding BackStageButton}" />
                                                    </local:RibbonWindowPanel>
                                                    <Border
                                                        Width="5"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="41"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="11"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="0,0,0,1"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="5"
                                                        Height="0.02"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="12"
                                                        DockPanel.Dock="Right" />
                                                    <Border
                                                        Height="23"
                                                        Margin="0,-23,0,1"
                                                        Panel.ZIndex="12"
                                                        Background="{StaticResource TransparentBrush}"
                                                        DockPanel.Dock="Right">
                                                        <ContentPresenter ContentSource="TabPanelItem" />
                                                    </Border>

                                                    <Border
                                                        Panel.ZIndex="10"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        DockPanel.Dock="Bottom">
                                                        <ItemsPresenter />
                                                        <Border.Style>
                                                            <Style>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Visible">
                                                                        <Setter Property="Border.Margin" Value="17,-25,0,1" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                        <Setter Property="Border.Margin" Value="-46,-25,0,1" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                    </Border>
                                                </DockPanel>


                                                <Border
                                                    x:Name="ribBorder"
                                                    Grid.Row="1"
                                                    Margin="0,-1,0,-6"
                                                    Padding="0"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="0,1,0,1">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <local:RibbonTabItemsControl
                                                            DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.DisplayMemberPath}"
                                                            Focusable="False"
                                                            ItemContainerStyle="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemContainerStyle}"
                                                            ItemContainerStyleSelector="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemContainerStyleSelector}"
                                                            ItemStringFormat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemStringFormat}"
                                                            ItemTemplate="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemTemplate}"
                                                            ItemTemplateSelector="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.ItemTemplateSelector}"
                                                            ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedTabItem.Items}">

                                                            <local:RibbonTabItemsControl.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <local:RibbonLayoutPanel />
                                                                </ItemsPanelTemplate>
                                                            </local:RibbonTabItemsControl.ItemsPanel>
                                                        </local:RibbonTabItemsControl>

                                                        <Grid Grid.Column="1" HorizontalAlignment="Right">
                                                            <local:RibbonToggleButton
                                                                x:Name="ToggleButton"
                                                                Width="29"
                                                                Height="22"
                                                                HorizontalAlignment="Right"
                                                                VerticalAlignment="Bottom"
                                                                Panel.ZIndex="12"
                                                                Style="{DynamicResource RibbonToggleButtonStyle}"
                                                                Visibility="{TemplateBinding MinimizeButtonVisibility}" />
                                                        </Grid>

                                                    </Grid>
                                                </Border>




                                                <Border
                                                    Name="PART_QAT"
                                                    Grid.Row="2"
                                                    Background="Transparent">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Setter Property="Margin" Value="0,6,0,0" />
                                                            <Style.Triggers>
                                                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                    <Setter Property="Margin" Value="0,1,0,0" />
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>

                                                    <ContentPresenter
                                                        HorizontalAlignment="Left"
                                                        Content="{TemplateBinding QuickAccessToolBar}"
                                                        DockPanel.Dock="Top" />

                                                </Border>
                                            </Grid>
                                        </Border>
                                    </AdornerDecorator>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="RibbonState" Value="Adorner">
                                            <Setter TargetName="PART_QAT" Property="Visibility" Value="Collapsed" />
                                        </Trigger>
                                        <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                            <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                        </Trigger>

                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized">
                                            <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0,-53,0,0" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=SelectedTabItem.HasContextTabGroup}" Value="True">



                                            <Setter TargetName="ribBorder" Property="BorderThickness" Value="0,0.6,0,0" />
                                            <Setter TargetName="ribBorder" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Converter={StaticResource colorToBrushConverter}, Path=SelectedContextTabGroupBackColor}" />
                                        </DataTrigger>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter Property="Height" Value="175" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </MultiTrigger>

                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Hide" />
                            <Condition Property="IsQATBelow" Value="False" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="0" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:Ribbon}">
                                    <AdornerDecorator
                                        Name="PART_AdornerDecorator"
                                        Margin="0,-53,0,0"
                                        Panel.ZIndex="100"
                                        DockPanel.Dock="Top">
                                        <Border>
                                            <Grid ClipToBounds="True">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="53" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="73" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>

                                                </Grid.RowDefinitions>
                                                <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                                    <local:RibbonWindowPanel
                                                        x:Name="PART_RibbonWindowPanel"
                                                        Panel.ZIndex="100"
                                                        DockPanel.Dock="Top">
                                                        <Border
                                                            x:Name="PART_TitleBorder"
                                                            Width="{TemplateBinding ActualWidth}"
                                                            Height="30"
                                                            Margin="0,0,0,-20"
                                                            Visibility="Collapsed" />
                                                        <ContentPresenter
                                                            Name="PART_ApplicationMenu"
                                                            Margin="0,20,0,0" Width="65"
                                                            Content="{TemplateBinding ApplicationMenu}"
                                                            ContentSource="ApplicationMenu">
                                                            <ContentPresenter.Style>
                                                                <Style>
                                                                    <Setter Property="FrameworkElement.Height" Value="38" />
                                                                    <Setter Property="FrameworkElement.Width" Value="38" />
                                                                    <Style.Triggers>
                                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                            <Setter Property="FrameworkElement.Height" Value="48" />
                                                                            <Setter Property="FrameworkElement.Width" Value="48" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentPresenter.Style>
                                                        </ContentPresenter>
                                                        <ContentPresenter
                                                            Margin="30,0,0,0"
                                                            HorizontalAlignment="Center"
                                                            shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                                            Content="{TemplateBinding QuickAccessToolBar}">
                                                            <ContentPresenter.Style>
                                                                <Style>
                                                                    <Setter Property="FrameworkElement.Height" Value="31" />
                                                                    <Style.Triggers>
                                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                            <Setter Property="FrameworkElement.Height" Value="35" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentPresenter.Style>
                                                        </ContentPresenter>
                                                    </local:RibbonWindowPanel>
                                                    <Border
                                                        Width="5"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="41"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="11"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="0,0,0,1"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="5"
                                                        Height="0.02"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="12"
                                                        DockPanel.Dock="Right" />
                                                    <Border
                                                        Panel.ZIndex="12"
                                                        Background="{StaticResource TransparentBrush}"
                                                        DockPanel.Dock="Right">
                                                        <Border.Style>
                                                            <Style>
                                                                <Setter Property="Border.Margin" Value="0,-23,0,1" />
                                                                <Setter Property="Border.Height" Value="23" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="Border.Margin" Value="0,-39,0,1" />
                                                                        <Setter Property="Border.Height" Value="40" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                        <ContentPresenter ContentSource="TabPanelItem" />
                                                    </Border>

                                                    <Border
                                                        x:Name="ribbonTabBorder"
                                                        Panel.ZIndex="10"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        DockPanel.Dock="Bottom">
                                                        <ItemsPresenter />
                                                        <Border.Style>
                                                            <Style>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Visible">
                                                                        <Setter Property="Border.Margin" Value="17,-25,0,2" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                        <Setter Property="Border.Margin" Value="-46,-25,0,2" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                    </Border>
                                                </DockPanel>


                                            </Grid>
                                        </Border>
                                    </AdornerDecorator>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                            <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                        </Trigger>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter TargetName="ribbonTabBorder" Property="Margin" Value="17,-27,0,2" />
                                        </Trigger>

                                        <!--
                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}},  Path=WindowState}" Value="Maximized">
                                    <Setter Property="Margin" TargetName="PART_AdornerDecorator" Value="0,-53,0,0"/>
                                    </DataTrigger>
                                        -->

                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </MultiTrigger>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized">
                        <Setter Property="Margin" Value="0,2,0,0" />
                    </DataTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Hide" />
                            <Condition Property="IsQATBelow" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="30" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:Ribbon}">
                                    <AdornerDecorator
                                        Name="PART_AdornerDecorator"
                                        Margin="0,-53,0,0"
                                        Panel.ZIndex="100"
                                        DockPanel.Dock="Top">
                                        <Border>
                                            <Grid ClipToBounds="True">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="53" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="73" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>
                                                    <RowDefinition Height="1" />
                                                    <RowDefinition Height="1" />
                                                    <RowDefinition>
                                                        <RowDefinition.Style>
                                                            <Style>
                                                                <Setter Property="RowDefinition.Height" Value="25" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                        <Setter Property="RowDefinition.Height" Value="40" />
                                                                    </Trigger>

                                                                </Style.Triggers>
                                                            </Style>
                                                        </RowDefinition.Style>
                                                    </RowDefinition>
                                                </Grid.RowDefinitions>
                                                <DockPanel Grid.Row="0" Panel.ZIndex="200">
                                                    <local:RibbonWindowPanel
                                                        x:Name="PART_RibbonWindowPanel"
                                                        Panel.ZIndex="100"
                                                        DockPanel.Dock="Top">
                                                        <Border
                                                            x:Name="PART_TitleBorder"
                                                            Width="{TemplateBinding ActualWidth}"
                                                            Height="30"
                                                            Margin="0,0,0,-20"
                                                            Visibility="Collapsed" />
                                                        <ContentPresenter
                                                            Name="PART_ApplicationMenu"
                                                            Margin="0,20,0,0" Width="65"
                                                            Content="{TemplateBinding ApplicationMenu}"
                                                            ContentSource="ApplicationMenu">
                                                            <ContentPresenter.Style>
                                                                <Style>
                                                                    <Setter Property="FrameworkElement.Height" Value="38" />
                                                                    <Setter Property="FrameworkElement.Width" Value="38" />
                                                                    <Style.Triggers>
                                                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                                                            <Setter Property="FrameworkElement.Height" Value="48" />
                                                                            <Setter Property="FrameworkElement.Width" Value="48" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ContentPresenter.Style>
                                                        </ContentPresenter>
                                                    </local:RibbonWindowPanel>
                                                    <Border
                                                        Width="5"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="41"
                                                        Height="0"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="11"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="0,0,0,1"
                                                        DockPanel.Dock="Left" />
                                                    <Border
                                                        Width="5"
                                                        Height="0.02"
                                                        Margin="0,-14,0,0"
                                                        Panel.ZIndex="12"
                                                        DockPanel.Dock="Right" />
                                                    <Border
                                                        Height="23"
                                                        Margin="0,-23,0,1"
                                                        Panel.ZIndex="12"
                                                        Background="{StaticResource TransparentBrush}"
                                                        DockPanel.Dock="Right">
                                                        <ContentPresenter ContentSource="TabPanelItem" />
                                                    </Border>

                                                    <Border
                                                        x:Name="ribbonTabBorder"
                                                        Panel.ZIndex="10"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        DockPanel.Dock="Bottom">
                                                        <ItemsPresenter />
                                                        <Border.Style>
                                                            <Style>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Visible">
                                                                        <Setter Property="Border.Margin" Value="17,-25,0,2" />
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=BackStageButton.Visibility}" Value="Collapsed">
                                                                        <Setter Property="Border.Margin" Value="-46,-25,0,2" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                    </Border>
                                                </DockPanel>

                                                <!--<Border Name="Test1"
                                                Grid.Row="1"
                                                Height="1"
                                                Margin="0,-3,0,0"
                                                Background="Transparent"
                                                BorderBrush="{StaticResource TransparentBrush}"
                                                BorderThickness="3,0,3,0" />
                                        <Border Name="Test2"
                                                Grid.Row="2"
                                                Height="1"
                                                Margin="3,-4,3,0"
                                                Background="Transparent" />-->
                                                <Border
                                                    Name="PART_QAT"
                                                    Grid.Row="3"
                                                    Padding="0,1,0,0"
                                                    Background="Transparent">

                                                    <ContentPresenter
                                                        HorizontalAlignment="Left"
                                                        Content="{TemplateBinding QuickAccessToolBar}"
                                                        DockPanel.Dock="Top" />

                                                </Border>
                                            </Grid>
                                        </Border>
                                    </AdornerDecorator>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="RibbonState" Value="Adorner">
                                            <Setter TargetName="PART_QAT" Property="Visibility" Value="Collapsed" />
                                        </Trigger>
                                        <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                                            <Setter TargetName="PART_AdornerDecorator" Property="Margin" Value="0" />
                                        </Trigger>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter Property="Height" Value="35" />
                                        </Trigger>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter TargetName="ribbonTabBorder" Property="Margin" Value="17,-27,0,2" />
                                        </Trigger>


                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </MultiTrigger>
                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                        <Setter Property="Height" Value="175" />
                    </Trigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Normal" />
                            <Condition Property="IsQATBelow" Value="False" />
                            <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="145" />
                    </MultiTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Normal" />
                            <Condition Property="IsQATBelow" Value="True" />
                            <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="185" />
                    </MultiTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Hide" />
                            <Condition Property="IsQATBelow" Value="False" />
                            <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="30" />
                    </MultiTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Hide" />
                            <Condition Property="IsQATBelow" Value="True" />
                            <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="75" />
                    </MultiTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Adorner" />
                            <Condition Property="IsQATBelow" Value="False" />
                            <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="30" />
                    </MultiTrigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="RibbonState" Value="Adorner" />
                            <Condition Property="IsQATBelow" Value="True" />
                            <Condition Property="shared:SkinStorage.EnableTouch" Value="True" />
                        </MultiTrigger.Conditions>
                        <Setter Property="Height" Value="40" />
                    </MultiTrigger>
                </Style.Triggers>
            </Style>

            <Style BasedOn="{StaticResource Office2013RibbonStyle}" TargetType="{x:Type local:Ribbon}" />

            <Style x:Key="1" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">
                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                                <ContentPresenter
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Content="{TemplateBinding Content}"
                                    RecognizesAccessKey="False"
                                    SnapsToDevicePixels="True" />
                            </Border>
                            <ControlTemplate.Triggers>

                                <!--
                            <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource HoverBrush}"/>


                            </Trigger>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TitleButtonAdorner}}, Path=IsPressed}" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource PressedBrush}"/>

                            </DataTrigger>
                                -->
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="CloseButtonStyle" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">
                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                                <Path
                                    x:Name="closepath"
                                    Width="8"
                                    Height="8"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="F1 M 531.513,330.307L 531.513,328.635L 533.185,328.635L 533.185,325.293L 529.842,325.293L 529.842,326.964L 528.171,326.964L 528.171,328.598L 524.828,328.598L 524.828,326.964L 523.157,326.964L 523.157,325.293L 519.814,325.293L 519.814,328.635L 521.485,328.635L 521.485,330.307L 523.157,330.307L 523.157,333.612L 521.485,333.612L 521.485,335.284L 519.814,335.284L 519.814,338.626L 523.157,338.626L 523.157,336.955L 524.828,336.955L 524.828,335.284L 528.171,335.284L 528.171,336.955L 529.842,336.955L 529.842,338.626L 533.185,338.626L 533.185,335.284L 531.513,335.284L 531.513,333.612L 529.842,333.612L 529.842,330.307L 531.513,330.307 Z "
                                    Fill="{StaticResource Office2013PathFill}"
                                    Stretch="Fill" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsActive}" Value="False">
                                    <Setter TargetName="closepath" Property="Fill" Value="#FFB1B1B1" />
                                </DataTrigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="closepath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="closepath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="MinimizeButtonStyle" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">
                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                                <Path
                                    x:Name="minpath"
                                    Width="9"
                                    Height="2"
                                    Margin="2,0,0,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M0.5,0.5 L8.5,0.5 L8.5,2.5 L0.5,2.5 z"
                                    Fill="{StaticResource Office2013PathFill}"
                                    SnapsToDevicePixels="True"
                                    Stretch="Fill"
                                    Stroke="{StaticResource Office2013PathFill}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsActive}" Value="False">
                                    <Setter TargetName="minpath" Property="Fill" Value="#FFB1B1B1" />
                                    <Setter TargetName="minpath" Property="Stroke" Value="#FFB1B1B1" />
                                </DataTrigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="minpath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="minpath" Property="Stroke" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="minpath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="minpath" Property="Stroke" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="FullScreenButtonStyle" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">
                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                                <Grid Width="12" Height="10">
                                    <Border
                                        x:Name="border1"
                                        Width="8"
                                        Height="6"
                                        Background="Transparent"
                                        BorderBrush="#FF7C7C7C"
                                        BorderThickness="1">
                                        <Border
                                            x:Name="innerborder"
                                            BorderBrush="#FFC8C8C8"
                                            BorderThickness="1" />
                                    </Border>
                                    <Border
                                        x:Name="topleft"
                                        Width="3"
                                        Height="3"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        Background="Transparent"
                                        BorderBrush="#FF7C7C7C"
                                        BorderThickness="1,1,0,0" />
                                    <Border
                                        x:Name="topright"
                                        Width="3"
                                        Height="3"
                                        HorizontalAlignment="right"
                                        VerticalAlignment="Top"
                                        Background="Transparent"
                                        BorderBrush="#FF7C7C7C"
                                        BorderThickness="0,1,1,0" />
                                    <Border
                                        x:Name="bottomright"
                                        Width="3"
                                        Height="3"
                                        HorizontalAlignment="right"
                                        VerticalAlignment="Bottom"
                                        Background="Transparent"
                                        BorderBrush="#FF7C7C7C"
                                        BorderThickness="0,0,1,1" />
                                    <Border
                                        x:Name="bottomleft"
                                        Width="3"
                                        Height="3"
                                        HorizontalAlignment="left"
                                        VerticalAlignment="Bottom"
                                        Background="Transparent"
                                        BorderBrush="#FF7C7C7C"
                                        BorderThickness="1,0,0,1" />
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="innerborder" Property="BorderBrush" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="topleft" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="topright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="bottomright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="bottomleft" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="innerborder" Property="BorderBrush" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="topleft" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="topright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="bottomright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="bottomright" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="HelpButtonStyle" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">
                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                                <Grid Width="12" Height="15">
                                    <Path
                                        x:Name="helppath"
                                        Width="7"
                                        Height="10"
                                        VerticalAlignment="Center"
                                        Data="M2.665,10.712 L6.5560003,10.712 6.5560003,13.333 2.665,13.333 z M1.3892639,0 L7.9436465,0 7.9436465,1.2838589 9.3330002,1.2838589 9.3330002,5.2447653 8.0557032,5.2447653 8.0557032,6.5832839 6.6664386,6.5832839 6.6664386,9.3170004 2.7232096,9.3170004 2.7232096,6.694613 3.9998672,6.694613 3.9998672,5.3000946 5.3331332,5.3000946 5.3331332,2.5670581 2.6665716,2.5670581 2.6665716,3.9615762 0,3.9615762 0,1.2838589 1.3332658,1.2838589 z"
                                        Fill="{StaticResource Office2013PathFill}"
                                        FlowDirection="LeftToRight"
                                        Stretch="Fill" />
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsActive}" Value="False">
                                    <Setter TargetName="helppath" Property="Fill" Value="#FFB1B1B1" />
                                </DataTrigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="helppath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="helppath" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="NormalButtonStyle" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">

                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">

                                <Grid Width="10" Height="10">

                                    <Border
                                        x:Name="border1"
                                        Width="8"
                                        Height="7"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Top"
                                        Background="Transparent"
                                        BorderBrush="{StaticResource Office2013PathFill}"
                                        BorderThickness="1,2,1,1" />
                                    <Border
                                        x:Name="border2"
                                        Width="8"
                                        Height="7"
                                        Margin="0,3,2,0"
                                        Background="White"
                                        BorderBrush="{StaticResource Office2013PathFill}"
                                        BorderThickness="1,2,1,1" />


                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsActive}" Value="False">
                                    <Setter TargetName="border1" Property="BorderBrush" Value="#FFB1B1B1" />
                                    <Setter TargetName="border2" Property="BorderBrush" Value="#FFB1B1B1" />
                                </DataTrigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="border2" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="border2" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                </Trigger>
                                <!--<DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TitleButtonAdorner}}, Path=IsMouseOver}" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                            <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                            <Setter TargetName="border2" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                        </DataTrigger>-->
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="border1" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="border2" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="MaximizeButtonStyle" TargetType="{x:Type local:WindowTitleBarButton}">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Focusable" Value="false" />
                <Setter Property="OverridesDefaultStyle" Value="True" />
                <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:WindowTitleBarButton}">

                            <Border
                                x:Name="PART_Border"
                                Panel.ZIndex="100"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">

                                <Border
                                    x:Name="maxpath"
                                    Width="10"
                                    Height="10"
                                    BorderBrush="{StaticResource Office2013PathFill}"
                                    BorderThickness="1,3,1,1"
                                    SnapsToDevicePixels="True" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsActive}" Value="False">
                                    <Setter TargetName="maxpath" Property="BorderBrush" Value="#FFB1B1B1" />
                                </DataTrigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="maxpath" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                                <!--<DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:TitleButtonAdorner}}, Path=IsMouseOver}" Value="True">
                            <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                            <Setter TargetName="maxpath" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                        </DataTrigger>-->
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_Border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="maxpath" Property="BorderBrush" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>


            <SolidColorBrush x:Key="Office2013TitleBarBackgroundBrush" Color="White" />
            <!--  TitleBar Style  -->
            <Style x:Key="TitleBarStyleKey" TargetType="{x:Type local:TitleBar}">
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Foreground" Value="{StaticResource RibbonForeground}" />
                <Setter Property="ClipToBounds" Value="False" />
                <Setter Property="Background" Value="{StaticResource Office2013TitleBarBackgroundBrush}" />
                <Setter Property="BorderBrush" Value="{StaticResource RibbonBorderBrush}" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:TitleBar}">

                            <Border
                                Margin="0,0,0,0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                                <Grid>
                                    <Border HorizontalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Right">


                                            <Image
                                                Grid.Column="1"
                                                Width="500"
                                                HorizontalAlignment="Right"
                                                Opacity="0.2"
                                                Source="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=TitleBarPatternImage}"
                                                Stretch="fill" />
                                        </Grid>
                                    </Border>
                                    <Grid Name="GlassActive" Height="{TemplateBinding Height}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15" />
                                            <ColumnDefinition Width="{Binding Path=QATColumnWidth, Converter={StaticResource DoubleToGridLengthConverter}, RelativeSource={RelativeSource TemplatedParent}}" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="{Binding Path=SysButtonsColumnWidth, Converter={StaticResource DoubleToGridLengthConverter}, RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Grid.ColumnDefinitions>

                                        <Grid Grid.Column="2" Margin="10,0,10,10">

                                            <TextBlock
                                                Name="PART_Title"
                                                Grid.Column="2"
                                                MaxWidth="{TemplateBinding TitleMaxWidth}"
                                                Margin="0,5,0,0"
                                                HorizontalAlignment="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=TitleTextAlignment}"
                                                VerticalAlignment="Top"
                                                FontFamily="{TemplateBinding FontFamily}"
                                                FontSize="{TemplateBinding FontSize}"
                                                Foreground="{TemplateBinding Foreground}"
                                                Text="{TemplateBinding Title}" />
                                        </Grid>
                                        <!--<Image
                                            x:Name="Part_SysIcon"
                                            Width="16"
                                            Height="16"
                                            Margin="8,5,-9,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top" Visibility="Collapsed"
                                            shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                            Source="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=Office2010Icon}"
                                            Stretch="Fill" />-->

                                        <StackPanel
                                            x:Name="stack"
                                            Grid.Column="3"
                                            Margin="0,3,0,0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Orientation="Horizontal">
                                            <local:WindowTitleBarButton
                                                x:Name="HelpButton"
                                                Width="29"
                                                Height="22"
                                                Style="{StaticResource HelpButtonStyle}"
                                                Visibility="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=ShowHelpButton, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                            <!-- <local:WindowTitleBarButton x:Name="FullScreenButton"
                                                                Width="29"
                                                                Height="22"
                                                                Style="{StaticResource FullScreenButtonStyle}"
                                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey},
                                                                                  Path=FullScreenTooltip}">

                                    </local:WindowTitleBarButton>-->
                                            <local:WindowTitleBarButton
                                                x:Name="MinButton"
                                                Width="29"
                                                Height="22"
                                                Style="{StaticResource MinimizeButtonStyle}"
                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey}, Path=MinimizeTooltip}" />
                                            <local:WindowTitleBarButton
                                                x:Name="MaxButton"
                                                Width="29"
                                                Height="22"
                                                Style="{StaticResource MaximizeButtonStyle}"
                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey}, Path=MaximizeTooltip}"
                                                Visibility="Collapsed" />
                                            <local:WindowTitleBarButton
                                                x:Name="NormalButton"
                                                Width="29"
                                                Height="22"
                                                Style="{StaticResource NormalButtonStyle}"
                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey}, Path=RestoreTooltip}" />
                                            <local:WindowTitleBarButton
                                                x:Name="CloseButton"
                                                Width="29"
                                                Height="22"
                                                Command="Close"
                                                Style="{StaticResource CloseButtonStyle}"
                                                ToolTip="{Binding Source={StaticResource ResourceWrapperKey}, Path=CloseTooltip}" />
                                        </StackPanel>

                                    </Grid>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <!--<DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=Office2010Icon}" Value="{x:Null}">
                                    <Setter TargetName="Part_SysIcon" Property="Visibility" Value="Collapsed" />

                                </DataTrigger>-->
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsActive}" Value="False">
                                    <Setter TargetName="PART_Title" Property="Foreground" Value="#FFB1B1B1" />
                                </DataTrigger>


                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                    </MultiDataTrigger.Conditions>
                                    <!--<Setter TargetName="Part_SysIcon" Property="Margin" Value="5,5,-7,0" />-->
                                    <Setter TargetName="stack" Property="Margin" Value="0,0,-2,0" />
                                </MultiDataTrigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="False" />
                                    </MultiDataTrigger.Conditions>
                                    <!--<Setter TargetName="Part_SysIcon" Property="Margin" Value="5,8,-5,0" />-->
                                    <Setter TargetName="stack" Property="Margin" Value="1,1,0,0" />
                                </MultiDataTrigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Normal">
                                    <Setter TargetName="MaxButton" Property="Visibility" Value="Visible" />

                                    <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized">
                                    <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="NormalButton" Property="Visibility" Value="Visible" />

                                </DataTrigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Minimized">
                                    <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="NormalButton" Property="Visibility" Value="Visible" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=ResizeMode}" Value="CanMinimize">
                                    <Setter TargetName="MaxButton" Property="IsEnabled" Value="False" />
                                </DataTrigger>
                                <!--
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}},  Path=ResizeMode}" Value="NoResize">
                            <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed"/>
                            <Setter Property="SysButtonsColumnWidth" Value="58"/>
                            </DataTrigger>



                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}},  Path=IsGlassActive}" Value="True">
                            <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="CloseButton" Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                                -->
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Normal" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="PART_Title" Property="BitmapEffect">
                                        <Setter.Value>
                                            <OuterGlowBitmapEffect
                                                GlowColor="#FFFFFFFF"
                                                GlowSize="14"
                                                Opacity="1" />
                                        </Setter.Value>
                                    </Setter>
                                </MultiDataTrigger>

                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>

                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowStyle}" Value="ToolWindow" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="CloseButton" Property="Visibility" Value="Visible" />
                                </MultiDataTrigger>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=MaximizedMode}" Value="KioskStyle" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowStyle}" Value="None" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="MinButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="MaxButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="NormalButton" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="CloseButton" Property="Visibility" Value="Collapsed" />
                                </MultiDataTrigger>


                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowState}" Value="Maximized" />
                                        <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowStyle}" Value="None" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="GlassActive" Property="Visibility" Value="Collapsed" />
                                </MultiDataTrigger>
                                <!--<Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="Part_SysIcon" Property="Margin" Value="8,13,-9,0" />
                                </Trigger>-->
                                <!--<MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding Path=(shared:SkinStorage.EnableTouch),RelativeSource={RelativeSource AncestorType={x:Type local:Ribbon}}}" Value="True"/>
                                <Condition Binding="{Binding IsQATBelow,RelativeSource={RelativeSource AncestorType={x:Type local:Ribbon}}}" Value="True"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Margin" TargetName="Part_SysIcon" Value="8,5,-9,0"/>
                        </MultiDataTrigger>-->

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="False">
                        <Setter Property="SysButtonsColumnWidth" Value="116" />
                    </DataTrigger>
                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="False" />
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=ShowHelpButton}" Value="false" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="SysButtonsColumnWidth" Value="116" />
                    </MultiDataTrigger>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=ResizeMode}" Value="NoResize">
                        <Setter Property="SysButtonsColumnWidth" Value="26" />
                    </DataTrigger>

                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="False" />
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowStyle}" Value="ToolWindow" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="SysButtonsColumnWidth" Value="26" />
                    </MultiDataTrigger>

                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=ResizeMode}" Value="CanResize" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="SysButtonsColumnWidth" Value="116" />
                    </MultiDataTrigger>

                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=ResizeMode}" Value="CanResizeWithGrip" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="SysButtonsColumnWidth" Value="116" />
                    </MultiDataTrigger>

                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowStyle}" Value="ToolWindow" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="SysButtonsColumnWidth" Value="20" />
                    </MultiDataTrigger>

                    <MultiDataTrigger>
                        <MultiDataTrigger.Conditions>
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=IsGlassActive}" Value="True" />
                            <Condition Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:RibbonWindow}}, Path=WindowStyle}" Value="None" />
                        </MultiDataTrigger.Conditions>
                        <Setter Property="SysButtonsColumnWidth" Value="0" />
                    </MultiDataTrigger>
                </Style.Triggers>
            </Style>


            <!--  RibbonWindow style  -->
            <Style x:Key="Office2013RibbonBackStageSeparatorStyle" TargetType="{x:Type local:BackStageSeparator}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:BackStageSeparator}">
                            <Grid MinHeight="24">
                                <Border
                                    Height="1"
                                    Margin="21,0"
                                    Background="{DynamicResource BackStageItemSelectedBrush}"
                                    SnapsToDevicePixels="True" />
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style BasedOn="{StaticResource Office2013RibbonBackStageSeparatorStyle}" TargetType="{x:Type local:BackStageSeparator}" />
            <SolidColorBrush x:Key="RibbonWindowBackground" Color="White" />
            <SolidColorBrush x:Key="RibbonWindowBorderBrush" Color="#FF2B579A" />
            <Style x:Key="Office2013RibbonWindowStyle" TargetType="{x:Type local:RibbonWindow}">
                <Setter Property="RibbonStatusBarStyle" Value="{StaticResource Office2013RibbonStatusBarStyle}" />
                <Setter Property="SnapsToDevicePixels" Value="True" />
                <Setter Property="MinWidth" Value="150" />
                <Setter Property="MinHeight" Value="150" />
                <Setter Property="FontSize" Value="12" />
                <Setter Property="BorderBrush" Value="{StaticResource RibbonWindowBorderBrush}" />
                <Setter Property="ShowHelpButton" Value="True" />
                <Setter Property="Background" Value="{StaticResource RibbonWindowBackground}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="TitleTextAlignment" Value="Center" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:RibbonWindow}">

                            <AdornerDecorator x:Name="PART_Adorner">

                                <Grid>
                                    <Grid.LayoutTransform>
                                        <ScaleTransform
                                            CenterX="0"
                                            CenterY="0"
                                            ScaleX="{Binding Path=ScaleX, RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}}"
                                            ScaleY="{Binding Path=ScaleY, RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}}" />
                                    </Grid.LayoutTransform>
                                    <Border
                                        Name="PART_MainBorder"
                                        Padding="{TemplateBinding Padding}"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}">
                                        <Border x:Name="PART_Border">

                                            <DockPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                <local:TitleBar
                                                    x:Name="PART_TitleBar"
                                                    Title="{TemplateBinding Title}"
                                                    Height="52"
                                                    Margin="2,0,0,0"
                                                    DockPanel.Dock="Top"
                                                    Style="{StaticResource TitleBarStyleKey}" />
                                                <Grid>
                                                    <DockPanel Background="{TemplateBinding Background}">
                                                        <ContentPresenter Content="{TemplateBinding StatusBar}" DockPanel.Dock="Bottom" />

                                                        <Grid DockPanel.Dock="Bottom">
                                                            <ContentPresenter Content="{TemplateBinding Content}" />
                                                            <ContentControl
                                                                x:Name="BackStageContent"
                                                                Content="{TemplateBinding BackStage}"
                                                                Visibility="Collapsed">
                                                                <ContentControl.RenderTransform>
                                                                    <TransformGroup>
                                                                        <ScaleTransform />
                                                                        <TranslateTransform />
                                                                    </TransformGroup>
                                                                </ContentControl.RenderTransform>
                                                            </ContentControl>
                                                        </Grid>
                                                    </DockPanel>

                                                    <Label
                                                        x:Name="PART_ResizeGrip"
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Bottom"
                                                        Cursor="SizeNWSE"
                                                        IsTabStop="False"
                                                        Visibility="Collapsed">
                                                        <Grid Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                                                            <Path Data="M 9,1 L 11,1 L 11,3 L 9,3 Z M 5,5 L 7,5 L 7,7 L 5,7 Z M 9,5 L 11,5 L 11,7 L 9,7 Z M 1,9 L 3,9 L 3,11 L 1,11 Z M 5,9 L 7,9 L 7,11 L 5,11 Z M 9,9 L 11,9 L 11,11 L 9,11 Z" Fill="{StaticResource Blue.ResizeGripperForegroundLight}" />

                                                            <Path Data="M 8,0 L 10,0 L 10,2 L 8,2 Z M 4,4 L 6,4 L 6,6 L 4,6 Z M 8,4 L 10,4 L 10,6 L 8,6 Z M 0,8 L 2,8 L 2,10 L 0,10 Z M 4,8 L 6,8 L 6,10 L 4,10 Z M 8,8 L 10,8 L 10,10 L 8,10 Z" Fill="{StaticResource Blue.ResizeGripperForegroundDark}" />
                                                        </Grid>
                                                    </Label>
                                                </Grid>
                                            </DockPanel>
                                        </Border>
                                    </Border>
                                </Grid>
                            </AdornerDecorator>
                            <ControlTemplate.Triggers>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="ResizeMode" Value="CanResizeWithGrip" />
                                        <Condition Property="WindowState" Value="Normal" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_ResizeGrip" Property="Visibility" Value="Visible" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="MaximizedMode" Value="KioskStyle" />
                                        <Condition Property="WindowState" Value="Maximized" />
                                        <Condition Property="WindowStyle" Value="None" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_TitleBar" Property="Visibility" Value="Collapsed" />
                                    <Setter Property="shell:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
                                </MultiTrigger>
                                <Trigger Property="WindowState" Value="Maximized">
                                    <Setter TargetName="PART_Border" Property="Margin" Value="{Binding Source={x:Static SystemParameters.ResizeFrameVerticalBorderWidth}, Converter={StaticResource Borderthickness}, ConverterParameter={x:Static SystemParameters.ResizeFrameHorizontalBorderHeight}}">
                                        <!--<Setter.Value>
                                    <Thickness Bottom="{x:Static SystemParameters.ResizeFrameHorizontalBorderHeight}"
                                               Left="{x:Static SystemParameters.ResizeFrameVerticalBorderWidth}"
                                               Right="{x:Static SystemParameters.ResizeFrameVerticalBorderWidth}"
                                               Top="4" />
                                </Setter.Value>-->
                                    </Setter>

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>


            </Style>

            <Style BasedOn="{StaticResource Office2013RibbonWindowStyle}" TargetType="{x:Type local:RibbonWindow}" />


            <!--  RibbonButton style  -->
            <Style x:Key="Office2013RibbonButtonStyle" TargetType="{x:Type local:RibbonButton}">
                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Foreground" Value="{StaticResource RibbonItemCaptionForeground}" />
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="BorderBrush" Value="Transparent" />
                <!--<Setter Property="Label" Value="New Button" />-->
                <Setter Property="CornerRadius" Value="0" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />

                <Style.Triggers>

                    <Trigger Property="SizeForm" Value="ExtraSmall">
                        <Setter Property="Padding" Value="3" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:RibbonButton}">
                                    <Border
                                        Name="OuterBorder"
                                        MinHeight="22"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="{TemplateBinding CornerRadius}"
                                        IsEnabled="{TemplateBinding IsEnabled}"
                                        Opacity="{TemplateBinding Opacity}">
                                        <Image
                                            x:Name="PART_Image"
                                            Width="16"
                                            Height="16"
                                            Margin="{TemplateBinding Padding}"
                                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                            Source="{Binding Path=SmallIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                            Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Border>
                                    <ControlTemplate.Triggers>

                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </Trigger>
                                        <Trigger Property="IsKeyboardFocused" Value="True">
                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemSelectedBrush}" />

                                        </Trigger>

                                        <MultiTrigger>
                                            <MultiTrigger.Conditions>
                                                <Condition Property="IsMouseOver" Value="True" />
                                                <Condition Property="IsSelected" Value="True" />
                                            </MultiTrigger.Conditions>

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </MultiTrigger>

                                        <Trigger Property="IsPressed" Value="True">

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />

                                        </Trigger>

                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                            <Setter Property="Opacity" Value="0.7" />
                                        </Trigger>

                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter Property="Padding" Value="5" />
                                            <Setter TargetName="PART_Image" Property="Height" Value="20" />
                                            <Setter TargetName="PART_Image" Property="Width" Value="20" />
                                        </Trigger>

                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>

                    <Trigger Property="SizeForm" Value="Small">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:RibbonButton}">
                                    <Grid HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}">
                                        <Border
                                            Name="OuterBorder"
                                            MinHeight="22"
                                            Padding="{TemplateBinding Padding}"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="{TemplateBinding CornerRadius}"
                                            IsEnabled="{TemplateBinding IsEnabled}"
                                            Opacity="{TemplateBinding Opacity}">
                                            <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Border
                                                    Name="PART_ImageBorder"
                                                    Grid.Column="0"
                                                    Margin="1">
                                                    <Image
                                                        x:Name="PART_Image"
                                                        Width="16"
                                                        Height="16"
                                                        Source="{Binding Path=SmallIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                        Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" />
                                                </Border>
                                                <local:RibbonAutomatableTextBlock
                                                    x:Name="label"
                                                    Grid.Column="1"
                                                    Margin="2,2,4,0"
                                                    HorizontalAlignment="Left"
                                                    FontFamily="{TemplateBinding FontFamily}"
                                                    FontSize="{TemplateBinding FontSize}"
                                                    Foreground="{TemplateBinding Foreground}"
                                                    Text="{TemplateBinding Label}" />
                                            </Grid>
                                        </Border>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSmallImageVisible" Value="False">
                                            <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                        </Trigger>

                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                        </Trigger>
                                        <Trigger Property="IsKeyboardFocused" Value="True">
                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemSelectedBrush}" />

                                        </Trigger>

                                        <MultiTrigger>
                                            <MultiTrigger.Conditions>
                                                <Condition Property="IsMouseOver" Value="True" />
                                                <Condition Property="IsSelected" Value="True" />
                                            </MultiTrigger.Conditions>

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </MultiTrigger>

                                        <Trigger Property="IsPressed" Value="True">

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />

                                        </Trigger>

                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                            <Setter TargetName="label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                            <Setter Property="Opacity" Value="0.7" />
                                        </Trigger>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter Property="Padding" Value="5" />
                                        </Trigger>

                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>

                    <Trigger Property="SizeForm" Value="Large">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type local:RibbonButton}">
                                    <Border
                                        Name="OuterBorder"
                                        Padding="{TemplateBinding Padding}"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="{TemplateBinding CornerRadius}"
                                        Opacity="{TemplateBinding Opacity}">
                                        <Grid HorizontalAlignment="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type local:RibbonButton}}}" VerticalAlignment="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type local:RibbonButton}}}">
                                            <StackPanel Orientation="Vertical">
                                                <Border
                                                    Name="PART_ImageBorder"
                                                    Margin="3"
                                                    SnapsToDevicePixels="True">
                                                    <Image
                                                        x:Name="PART_Image"
                                                        Width="32"
                                                        Height="32"
                                                        Source="{Binding Path=LargeIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                        Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" />
                                                </Border>
                                                <ItemsControl
                                                    x:Name="PART_Label"
                                                    Margin="0,3,0,2"
                                                    Focusable="False"
                                                    Foreground="{TemplateBinding Foreground}">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <local:MultilinePanel />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                    <ItemsControl.ItemContainerStyle>
                                                        <Style TargetType="{x:Type TextBlock}">
                                                            <Setter Property="Foreground" Value="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ItemsControl}}}" />
                                                        </Style>
                                                    </ItemsControl.ItemContainerStyle>
                                                </ItemsControl>
                                            </StackPanel>

                                        </Grid>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsLargeImageVisible" Value="False">
                                            <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                        </Trigger>

                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </Trigger>
                                        <Trigger Property="IsKeyboardFocused" Value="True">
                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemSelectedBrush}" />

                                        </Trigger>

                                        <MultiTrigger>
                                            <MultiTrigger.Conditions>
                                                <Condition Property="IsMouseOver" Value="True" />
                                                <Condition Property="IsSelected" Value="True" />
                                            </MultiTrigger.Conditions>

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                        </MultiTrigger>

                                        <Trigger Property="IsPressed" Value="True">

                                            <Setter TargetName="OuterBorder" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />

                                        </Trigger>

                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter TargetName="PART_Image" Property="Effect" Value="{StaticResource DisableEffect}" />
                                            <Setter TargetName="PART_Label" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                            <Setter Property="Opacity" Value="0.7" />
                                        </Trigger>
                                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                            <Setter TargetName="PART_Image" Property="Height" Value="48" />
                                            <Setter TargetName="PART_Image" Property="Width" Value="48" />
                                            <Setter TargetName="PART_Label" Property="Margin" Value="0,10,0,2" />
                                        </Trigger>

                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <Style BasedOn="{StaticResource Office2013RibbonButtonStyle}" TargetType="{x:Type local:RibbonButton}" />

            <Style x:Key="BackstageButtonStyle" TargetType="{x:Type local:RibbonButton}">
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:RibbonButton}">
                            <Grid Background="Transparent">
                                <Ellipse
                                    x:Name="ellipse1"
                                    Width="35"
                                    Height="35"
                                    Fill="Transparent"
                                    Stroke="White"
                                    StrokeThickness="2" />
                                <Path
                                    x:Name="path1"
                                    Width="18"
                                    Height="13"
                                    Data="F1 M 536.526,366.592L 528.898,358.964L 536.526,351.335L 540.988,351.327L 535.016,357.3L 553.101,357.3L 553.101,360.588L 534.974,360.588L 540.979,366.592L 536.526,366.592 Z "
                                    Fill="White"
                                    Stretch="Fill" />
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="path1" Property="Fill" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                    <Setter TargetName="ellipse1" Property="Stroke" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />

                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

       
            <!--  BackStage Button Style  -->
            <Style TargetType="{x:Type local:BackStageButton}">
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:BackStageButton}">
                            <Border
                                x:Name="border2"
                                Height="25"
                                MinWidth="62"
                                Margin="0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Background="{Binding Path=BackStageColor, RelativeSource={RelativeSource AncestorType={x:Type local:Ribbon}}}"
                                SnapsToDevicePixels="True">
                                <Grid>
                                    <TextBlock
                                        x:Name="contentPresenter"
                                        Margin="0,5"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        SnapsToDevicePixels="True"
                                        Text="{TemplateBinding Header}"
                                        TextBlock.Foreground="{StaticResource Office2013BackstageButtonForeground}"
                                        TextTrimming="CharacterEllipsis"
                                        TextWrapping="NoWrap">
                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="4"
                                                Opacity="0.605"
                                                ShadowDepth="0" />
                                        </TextBlock.Effect>
                                    </TextBlock>

                                </Grid>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <SolidColorBrush x:Key="Office2013BackstageTabforeground" Color="White" />
         
            <!--  Ribbon Minimize Button  -->

            <Style x:Key="RibbonToggleButtonStyle" TargetType="{x:Type local:RibbonToggleButton}">
                <Setter Property="Height" Value="22" />
                <Setter Property="Width" Value="29" />
                <Setter Property="Label" Value="Collapse the Ribbon" />
                <Setter Property="IconHeight" Value="7" />
                <Setter Property="IconWidth" Value="5" />
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:RibbonToggleButton}">
                            <Grid>
                                <Border
                                    x:Name="border"
                                    Width="29"
                                    Height="22"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Stretch"
                                    Background="Transparent">
                                    <Grid>
                                        <Path
                                            x:Name="path1"
                                            Width="7"
                                            Height="5"
                                            VerticalAlignment="Center"
                                            Data="M4.0209999,0 L5.313,0 5.313,1.3329999 6.6670001,1.3329999 6.6670001,2.667 7.9789999,2.667 7.9999998,2.667 7.9999998,3.9380001 9.3329999,3.9380001 9.3329999,6.6670001 6.6460001,6.6670001 6.6460001,5.313 5.3329999,5.313 5.3329999,3.9790001 5.313,3.9790001 5.313,4 4.0209999,4 4.0209999,3.9790001 4,3.9790001 4,5.313 2.6869999,5.313 2.6869999,6.6670001 0,6.6670001 0,3.9580001 &#10;1.333,3.9580001 1.333,2.667 1.3539999,2.667 2.6869999,2.667 2.6869999,1.3329999 4.0209999,1.3329999 z"
                                            Fill="#FF777777"
                                            Stretch="Fill" />
                                        <Path
                                            x:Name="path2"
                                            Width="10"
                                            Height="8"
                                            Data="M5.3329997,0 L6.6939998,0 6.6939998,1.3620001 7.9999998,1.3620001 7.9999998,2.667 12,2.667 12,1.3620001 13.361,1.3620001 13.361,9.3069999 12,9.3069999 12,8.0000002 7.9999998,8.0000002 7.9999998,9.3339999 6.6939998,9.3339999 6.6939998,10.641 5.3329997,10.641 5.3329997,6.6670001 0,6.6670001 0,3.9740001 5.3329997,3.9740001 z"
                                            Fill="#FF777777"
                                            Stretch="Fill"
                                            Visibility="Collapsed" />
                                    </Grid>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>


                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=RibbonState}" Value="Normal">
                                    <Setter TargetName="path2" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="path1" Property="Visibility" Value="Visible" />
                                </DataTrigger>



                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Ribbon}}, Path=RibbonState}" Value="Adorner">
                                    <Setter TargetName="path2" Property="Visibility" Value="Visible" />
                                    <Setter TargetName="path1" Property="Visibility" Value="Collapsed" />
                                </DataTrigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="path2" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="path1" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />


                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsPressed" Value="False" />
                                    </MultiTrigger.Conditions>

                                    <Setter TargetName="border" Property="Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsKeyboardFocusWithin" Value="True" />
                                        <Condition Property="IsPressed" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path2" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="path1" Property="Fill" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:RibbonWindow}}, Path=BackStageColor}" />
                                    <Setter TargetName="border" Property="Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />

                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!--  Ribbon ToggleButton Style  -->

            <Style x:Key="Office2013RibbonToggleButtonStyle" TargetType="local:RibbonToggleButton">
                <Setter Property="Foreground" Value="{StaticResource RibbonForeground}" />

                <Setter Property="Label" Value="RibbonToggleButton" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="BorderBrush" Value="Transparent" />
                <Setter Property="MinHeight" Value="22" />
                <Setter Property="Focusable" Value="False" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="local:RibbonToggleButton">
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="true">
                                    <Setter TargetName="ItemBorder" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                    <Setter TargetName="ItemBorder1" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemHoverBrush}" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="ItemBorder" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="ItemBorder1" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="InnerBorder" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="InnerBorder1" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="ItemBorder" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="ItemBorder1" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="InnerBorder" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                    <Setter TargetName="InnerBorder1" Property="Border.Background" Value="{DynamicResource Office2013RibbonItemPressedBrush}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="ItemBorder" Property="Border.Opacity" Value="0.5" />
                                    <Setter TargetName="ItemBorder1" Property="Border.Opacity" Value="0.5" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                            <Grid>
                                <Border
                                    x:Name="ItemCheckedBorder"
                                    Background="Transparent"
                                    BorderBrush="Transparent"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="1"
                                    Opacity="0" />
                                <Border
                                    Name="ItemBorder"
                                    MinHeight="22"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="3"
                                    SnapsToDevicePixels="True">
                                    <Border
                                        x:Name="InnerBorder"
                                        Margin="1,1,1,0"
                                        Background="Transparent"
                                        CornerRadius="2">
                                        <Grid Margin="{TemplateBinding Padding}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <Border Name="PART_ImageBorder" Grid.Column="0">
                                                <Image
                                                    x:Name="smallImage"
                                                    Width="{Binding Path=IconWidth, RelativeSource={RelativeSource AncestorType={x:Type local:RibbonToggleButton}}}"
                                                    Height="{Binding Path=IconHeight, RelativeSource={RelativeSource AncestorType={x:Type local:RibbonToggleButton}}}"
                                                    Margin="2"
                                                    Source="{Binding Path=SmallIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                    Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" />
                                            </Border>
                                            <AccessText
                                                x:Name="PART_Text"
                                                Grid.Column="1"
                                                Margin="2,0,4,0"
                                                HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                                VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                FontFamily="{TemplateBinding FontFamily}"
                                                FontSize="{TemplateBinding FontSize}"
                                                Foreground="{TemplateBinding Foreground}"
                                                IsHitTestVisible="False"
                                                Text="{TemplateBinding Label}" />
                                        </Grid>
                                    </Border>
                                </Border>
                                <Border
                                    Name="ItemBorder1"
                                    MinHeight="22"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    SnapsToDevicePixels="True"
                                    Visibility="Collapsed">
                                    <Border
                                        x:Name="InnerBorder1"
                                        Margin="1,1,1,0"
                                        Background="Transparent"
                                        CornerRadius="2">
                                        <StackPanel Margin="{TemplateBinding Padding}">
                                            <Border Name="PART_ImageBorderLarge">
                                                <Image
                                                    x:Name="LargeImage"
                                                    Width="26"
                                                    Height="26"
                                                    Margin="2"
                                                    Source="{Binding Path=LargeIcon, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                    Stretch="{Binding Path=IconStretch, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" />
                                            </Border>
                                            <ItemsControl
                                                x:Name="PART_TextAreaLarge"
                                                Margin="2,0,4,0"
                                                HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                                VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                IsHitTestVisible="False" />
                                        </StackPanel>
                                    </Border>
                                </Border>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style BasedOn="{StaticResource Office2013RibbonToggleButtonStyle}" TargetType="local:RibbonToggleButton" />

            
        </ResourceDictionary>


    </Application.Resources>
</Application>
